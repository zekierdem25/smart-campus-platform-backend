{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\zekierdem\\\\Desktop\\\\web_final\\\\frontend\\\\src\\\\context\\\\AuthContext.jsx\",\n  _s = $RefreshSig$();\nimport { createContext, useState, useEffect } from \"react\";\nimport api from \"../api/axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport function AuthProvider({\n  children\n}) {\n  _s();\n  const [accessToken, setAccessToken] = useState(localStorage.getItem(\"accessToken\") || null);\n  const [user, setUser] = useState(null);\n\n  // Token deÄŸiÅŸtiÄŸinde kullanÄ±cÄ± bilgilerini Ã§ek\n  useEffect(() => {\n    if (accessToken) {\n      fetchMe();\n    }\n  }, [accessToken]);\n\n  // --- KULLANICI BILGISI Ã‡EKME ---\n  async function fetchMe() {\n    try {\n      console.log(\"â†’ GET /users/me\");\n      const res = await api.get(\"/users/me\", {\n        headers: {\n          Authorization: `Bearer ${accessToken}`\n        }\n      });\n      console.log(\"âœ“ Me response:\", res.data);\n      // Backend returns ApiResponseDto<UserResponseDto>, so the user object is in .data property\n      setUser(res.data.data || res.data.user);\n    } catch (err) {\n      console.error(\"âœ— Me fetch error:\", err);\n      logout();\n    }\n  }\n\n  // --- LOGIN ---\n  // --- LOGIN ---\n  async function login(email, password) {\n    try {\n      const res = await api.post(\"/auth/login\", {\n        email,\n        password\n      });\n\n      // Backend genel olarak ApiResponseDto dÃ¶ndÃ¼rÃ¼yor:\n      // { success: bool, message: string, data: ..., accessToken: \"...\" }\n      if (!res.data.success || !res.data.accessToken) {\n        return {\n          ok: false,\n          message: res.data.message || \"GiriÅŸ baÅŸarÄ±sÄ±z. LÃ¼tfen e-posta adresinizi ve ÅŸifrenizi kontrol edin.\"\n        };\n      }\n      const token = res.data.accessToken;\n\n      // 1) Ã–nce localStorage'a yaz\n      localStorage.setItem(\"accessToken\", token);\n\n      // 2) Sonra state'i gÃ¼ncelle\n      setAccessToken(token);\n\n      // 3) fetchMe Ã§aÄŸrÄ±sÄ±nÄ± burada manuel tetiklemiyoruz;\n      // accessToken deÄŸiÅŸtiÄŸinde useEffect iÃ§indeki fetchMe otomatik Ã§alÄ±ÅŸÄ±yor.\n\n      return {\n        ok: true,\n        message: \"GiriÅŸ baÅŸarÄ±lÄ±. YÃ¶nlendiriliyorsunuz...\"\n      };\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(\"âœ— Login error:\", err);\n      const message = (err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || \"GiriÅŸ sÄ±rasÄ±nda bir hata oluÅŸtu. LÃ¼tfen daha sonra tekrar deneyin.\";\n      return {\n        ok: false,\n        message\n      };\n    }\n  }\n  function logout() {\n    console.log(\"â†’ logout()\");\n    localStorage.removeItem(\"accessToken\");\n    setAccessToken(null);\n    setUser(null);\n  }\n\n  // ðŸ”¹ Profil gÃ¼ncellemeden sonra global user bilgisini yenilemek iÃ§in\n  function updateUser(updatedUser) {\n    setUser(updatedUser);\n  }\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      accessToken,\n      login,\n      logout,\n      updateUser // â¬…ï¸ bunu ekledik\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 5\n  }, this);\n}\n_s(AuthProvider, \"Df28R4vydTt4kFo4iyjz4YdnpDY=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useState","useEffect","api","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","accessToken","setAccessToken","localStorage","getItem","user","setUser","fetchMe","console","log","res","get","headers","Authorization","data","err","error","logout","login","email","password","post","success","ok","message","token","setItem","_err$response","_err$response$data","response","removeItem","updateUser","updatedUser","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/zekierdem/Desktop/web_final/frontend/src/context/AuthContext.jsx"],"sourcesContent":["import { createContext, useState, useEffect } from \"react\";\r\nimport api from \"../api/axios\";\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [accessToken, setAccessToken] = useState(\r\n    localStorage.getItem(\"accessToken\") || null\r\n  );\r\n\r\n  const [user, setUser] = useState(null);\r\n\r\n  // Token deÄŸiÅŸtiÄŸinde kullanÄ±cÄ± bilgilerini Ã§ek\r\n  useEffect(() => {\r\n    if (accessToken) {\r\n      fetchMe();\r\n    }\r\n  }, [accessToken]);\r\n\r\n  // --- KULLANICI BILGISI Ã‡EKME ---\r\n  async function fetchMe() {\r\n    try {\r\n      console.log(\"â†’ GET /users/me\");\r\n      const res = await api.get(\"/users/me\", {\r\n        headers: { Authorization: `Bearer ${accessToken}` },\r\n      });\r\n\r\n      console.log(\"âœ“ Me response:\", res.data);\r\n      // Backend returns ApiResponseDto<UserResponseDto>, so the user object is in .data property\r\n      setUser(res.data.data || res.data.user);\r\n    } catch (err) {\r\n      console.error(\"âœ— Me fetch error:\", err);\r\n      logout();\r\n    }\r\n  }\r\n\r\n  // --- LOGIN ---\r\n// --- LOGIN ---\r\nasync function login(email, password) {\r\n  try {\r\n    const res = await api.post(\"/auth/login\", { email, password });\r\n\r\n    // Backend genel olarak ApiResponseDto dÃ¶ndÃ¼rÃ¼yor:\r\n    // { success: bool, message: string, data: ..., accessToken: \"...\" }\r\n    if (!res.data.success || !res.data.accessToken) {\r\n      return {\r\n        ok: false,\r\n        message:\r\n          res.data.message ||\r\n          \"GiriÅŸ baÅŸarÄ±sÄ±z. LÃ¼tfen e-posta adresinizi ve ÅŸifrenizi kontrol edin.\",\r\n      };\r\n    }\r\n\r\n    const token = res.data.accessToken;\r\n\r\n    // 1) Ã–nce localStorage'a yaz\r\n    localStorage.setItem(\"accessToken\", token);\r\n\r\n    // 2) Sonra state'i gÃ¼ncelle\r\n    setAccessToken(token);\r\n\r\n    // 3) fetchMe Ã§aÄŸrÄ±sÄ±nÄ± burada manuel tetiklemiyoruz;\r\n    // accessToken deÄŸiÅŸtiÄŸinde useEffect iÃ§indeki fetchMe otomatik Ã§alÄ±ÅŸÄ±yor.\r\n\r\n    return {\r\n      ok: true,\r\n      message: \"GiriÅŸ baÅŸarÄ±lÄ±. YÃ¶nlendiriliyorsunuz...\",\r\n    };\r\n  } catch (err) {\r\n    console.error(\"âœ— Login error:\", err);\r\n    const message =\r\n      err?.response?.data?.message ||\r\n      \"GiriÅŸ sÄ±rasÄ±nda bir hata oluÅŸtu. LÃ¼tfen daha sonra tekrar deneyin.\";\r\n    return {\r\n      ok: false,\r\n      message,\r\n    };\r\n  }\r\n}\r\n\r\n\r\n  function logout() {\r\n    console.log(\"â†’ logout()\");\r\n    localStorage.removeItem(\"accessToken\");\r\n    setAccessToken(null);\r\n    setUser(null);\r\n  }\r\n\r\n  // ðŸ”¹ Profil gÃ¼ncellemeden sonra global user bilgisini yenilemek iÃ§in\r\n  function updateUser(updatedUser) {\r\n    setUser(updatedUser);\r\n  }\r\n\r\n    return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        user,\r\n        accessToken,\r\n        login,\r\n        logout,\r\n        updateUser, // â¬…ï¸ bunu ekledik\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}