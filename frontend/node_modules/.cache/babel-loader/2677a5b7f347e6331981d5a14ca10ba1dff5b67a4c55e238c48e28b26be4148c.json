{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\zekierdem\\\\Desktop\\\\web_final\\\\frontend\\\\src\\\\pages\\\\Profile.jsx\",\n  _s = $RefreshSig$();\n// frontend/src/pages/Profile.jsx\nimport { useContext, useEffect, useState, useRef } from \"react\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport api from \"../api/axios\";\nimport \"../App.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Profile() {\n  _s();\n  var _user$firstName, _user$firstName$;\n  const {\n    user,\n    updateUser\n  } = useContext(AuthContext);\n  const fileInputRef = useRef(null);\n  const [form, setForm] = useState({\n    firstName: \"\",\n    lastName: \"\",\n    phone: \"\"\n  });\n  const [isSaving, setIsSaving] = useState(false);\n  const [photoFile, setPhotoFile] = useState(null);\n  const [photoMessage, setPhotoMessage] = useState(\"\");\n  const [previewUrl, setPreviewUrl] = useState(null);\n\n  // Şifre state'leri\n  const [passForm, setPassForm] = useState({\n    current: \"\",\n    new: \"\",\n    newAgain: \"\"\n  });\n  const [passMessage, setPassMessage] = useState(\"\");\n  useEffect(() => {\n    if (user) {\n      setForm({\n        firstName: user.firstName || \"\",\n        lastName: user.lastName || \"\",\n        phone: user.phone || \"\"\n      });\n    }\n  }, [user]);\n\n  // Clean up object URL when component unmounts or previewUrl changes\n  useEffect(() => {\n    return () => {\n      if (previewUrl && previewUrl.startsWith(\"blob:\")) {\n        URL.revokeObjectURL(previewUrl);\n      }\n    };\n  }, [previewUrl]);\n  if (!user) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"profile-page\",\n    children: \"Y\\xFCkleniyor...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 45,\n    columnNumber: 21\n  }, this);\n  const handleChange = e => {\n    setForm({\n      ...form,\n      [e.target.name]: e.target.value\n    });\n  };\n  const handlePassChange = e => {\n    setPassForm({\n      ...passForm,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  // --- KAYDET ---\n  const handleSaveProfile = async e => {\n    e.preventDefault();\n    setIsSaving(true);\n    try {\n      var _res$data;\n      const res = await api.put(\"/users/me\", form);\n      updateUser(((_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.user) || {\n        ...user,\n        ...form\n      });\n      alert(\"Profil başarıyla güncellendi!\");\n    } catch (err) {\n      var _err$response, _err$response$data;\n      alert(\"Hata oluştu: \" + (((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || err.message));\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  // --- FOTOĞRAF SEÇME ---\n  const handleFileSelect = e => {\n    if (e.target.files && e.target.files[0]) {\n      const file = e.target.files[0];\n      setPhotoFile(file);\n\n      // Create preview\n      const objectUrl = URL.createObjectURL(file);\n      setPreviewUrl(objectUrl);\n      setPhotoMessage(\"Fotoğraf seçildi. Yüklemek için butona basınız.\");\n    }\n  };\n\n  // --- FOTOĞRAF YÜKLEME ---\n  const handleUploadPhoto = async () => {\n    if (!photoFile) {\n      setPhotoMessage(\"Lütfen önce bir fotoğraf seçin.\");\n      return;\n    }\n    try {\n      var _meRes$data;\n      const formData = new FormData();\n      formData.append(\"profilePicture\", photoFile);\n      formData.append(\"file\", photoFile);\n\n      // 1) Upload photo\n      await api.post(\"/users/me/profile-picture\", formData);\n\n      // 2) Fetch user again\n      const meRes = await api.get(\"/users/me\");\n\n      // Check for .data.data per strict DTO\n      if ((_meRes$data = meRes.data) !== null && _meRes$data !== void 0 && _meRes$data.data) {\n        // Cache busting logic\n        const updatedUser = {\n          ...meRes.data.data\n        };\n        if (updatedUser.profilePictureUrl) {\n          updatedUser.profilePictureUrl = `${updatedUser.profilePictureUrl}?t=${new Date().getTime()}`;\n        }\n        updateUser(updatedUser);\n        setPhotoMessage(\"Profil fotoğrafı güncellendi!\");\n        setPreviewUrl(null); // Reset preview after successful upload\n        setPhotoFile(null);\n      } else {\n        setPhotoMessage(\"Yükleme başarılı ama kullanıcı bilgisi alınamadı. Lütfen sayfayı yenileyin.\");\n      }\n    } catch (err) {\n      var _err$response2, _err$response2$data, _err$response3;\n      console.error(\"Upload error:\", err.response || err);\n      setPhotoMessage(\"Yükleme başarısız: \" + (((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || ((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : _err$response3.data) || err.message || \"Bilinmeyen hata\"));\n    }\n  };\n\n  // --- ŞİFRE DEĞİŞTİRME ---\n  const handlePasswordSubmit = async () => {\n    setPassMessage(\"\");\n    if (!passForm.current || !passForm.new || !passForm.newAgain) {\n      setPassMessage(\"Lütfen tüm alanları doldurunuz.\");\n      return;\n    }\n    if (passForm.new !== passForm.newAgain) {\n      setPassMessage(\"Yeni şifreler eşleşmiyor.\");\n      return;\n    }\n    try {\n      await api.post(\"/users/me/change-password\", {\n        currentPassword: passForm.current,\n        newPassword: passForm.new,\n        confirmPassword: passForm.newAgain\n      });\n      alert(\"Şifreniz başarıyla güncellendi!\");\n      setPassForm({\n        current: \"\",\n        new: \"\",\n        newAgain: \"\"\n      });\n    } catch (err) {\n      var _err$response4, _err$response4$data;\n      console.error(err);\n      setPassMessage(((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.message) || \"Şifre değiştirilirken hata oluştu.\");\n    }\n  };\n  const fullName = `${user.firstName || \"\"} ${user.lastName || \"\"}`.trim();\n\n  // Determine Avatar URL\n  // Priority: Preview -> User's Profile Picture -> Fallback to null\n  let avatarUrl = previewUrl || user.profilePictureUrl || user.profilePictureURL || user.profilePicture || user.avatarUrl || user.avatar || null;\n\n  // Fix URL if it's from backend and relative\n  if (avatarUrl && !avatarUrl.startsWith(\"http\") && !avatarUrl.startsWith(\"blob:\")) {\n    avatarUrl = `http://localhost:5000${avatarUrl.startsWith(\"/\") ? \"\" : \"/\"}${avatarUrl}`;\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"profile-page\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"profile-title\",\n        children: \"Profil Ayarlar\\u0131\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"avatar-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"avatar-circle\",\n            children: avatarUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n              src: avatarUrl,\n              alt: \"Avatar\",\n              className: \"avatar-img\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 184,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n              children: (_user$firstName = user.firstName) === null || _user$firstName === void 0 ? void 0 : (_user$firstName$ = _user$firstName[0]) === null || _user$firstName$ === void 0 ? void 0 : _user$firstName$.toUpperCase()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            ref: fileInputRef,\n            onChange: handleFileSelect,\n            className: \"hidden-input\",\n            accept: \"image/*\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 13\n          }, this), !photoFile ? /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"custom-file-upload\",\n            onClick: () => fileInputRef.current.click(),\n            children: \"Foto\\u011Fraf De\\u011Fi\\u015Ftir\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"btn-save\",\n            style: {\n              fontSize: '12px',\n              padding: '8px 16px',\n              marginTop: '5px'\n            },\n            onClick: handleUploadPhoto,\n            children: \"Onayla ve Y\\xFCkle\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 15\n          }, this), photoMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              fontSize: '12px',\n              marginTop: 5,\n              color: '#e67e22'\n            },\n            children: photoMessage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: fullName || \"Kullanıcı\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"role-badge\",\n            children: user.role === \"admin\" ? \"Yönetici\" : user.role === \"faculty\" ? \"Öğretim Üyesi\" : \"Öğrenci\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"info-text\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"E-posta:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 38\n            }, this), \" \", user.email]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 13\n          }, this), user.studentInfo && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"info-text\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"No:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 17\n            }, this), \" \", user.studentInfo.studentNumber, \" | \", /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"B\\xF6l\\xFCm:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 73\n            }, this), \" \", user.studentInfo.departmentName]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n        style: {\n          border: '0',\n          borderTop: '1px solid #eee',\n          margin: '0 0 30px 0'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSaveProfile,\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"section-header\",\n          children: \"Ki\\u015Fisel Bilgiler\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Ad\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-input\",\n              name: \"firstName\",\n              value: form.firstName,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Soyad\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-input\",\n              name: \"lastName\",\n              value: form.lastName,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Telefon\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-input\",\n              name: \"phone\",\n              value: form.phone,\n              onChange: handleChange,\n              placeholder: \"0555...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 255,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 253,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"E-posta (De\\u011Fi\\u015Ftirilemez)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-input\",\n              value: user.email,\n              disabled: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'right',\n            marginBottom: '30px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"btn-save\",\n            disabled: isSaving,\n            children: isSaving ? \"Kaydediliyor...\" : \"Bilgileri Güncelle\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n        style: {\n          border: '0',\n          borderTop: '1px solid #eee',\n          margin: '0 0 30px 0'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"section-header\",\n        children: \"G\\xFCvenlik\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-row\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Mevcut \\u015Eifre\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"form-input\",\n            type: \"password\",\n            name: \"current\",\n            value: passForm.current,\n            onChange: handlePassChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Yeni \\u015Eifre\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"form-input\",\n            type: \"password\",\n            name: \"new\",\n            value: passForm.new,\n            onChange: handlePassChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Yeni \\u015Eifre (Tekrar)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"form-input\",\n            type: \"password\",\n            name: \"newAgain\",\n            value: passForm.newAgain,\n            onChange: handlePassChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"btn-save\",\n        style: {\n          backgroundColor: '#607d8b'\n        },\n        onClick: handlePasswordSubmit,\n        children: \"\\u015Eifreyi G\\xFCncelle\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 9\n      }, this), passMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          marginTop: 10,\n          color: '#e74c3c'\n        },\n        children: passMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 25\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 175,\n    columnNumber: 5\n  }, this);\n}\n_s(Profile, \"ed0prPfnvjOJTG70A1BBgsug5i4=\");\n_c = Profile;\nvar _c;\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"names":["useContext","useEffect","useState","useRef","AuthContext","api","jsxDEV","_jsxDEV","Profile","_s","_user$firstName","_user$firstName$","user","updateUser","fileInputRef","form","setForm","firstName","lastName","phone","isSaving","setIsSaving","photoFile","setPhotoFile","photoMessage","setPhotoMessage","previewUrl","setPreviewUrl","passForm","setPassForm","current","new","newAgain","passMessage","setPassMessage","startsWith","URL","revokeObjectURL","className","children","fileName","_jsxFileName","lineNumber","columnNumber","handleChange","e","target","name","value","handlePassChange","handleSaveProfile","preventDefault","_res$data","res","put","data","alert","err","_err$response","_err$response$data","response","message","handleFileSelect","files","file","objectUrl","createObjectURL","handleUploadPhoto","_meRes$data","formData","FormData","append","post","meRes","get","updatedUser","profilePictureUrl","Date","getTime","_err$response2","_err$response2$data","_err$response3","console","error","handlePasswordSubmit","currentPassword","newPassword","confirmPassword","_err$response4","_err$response4$data","fullName","trim","avatarUrl","profilePictureURL","profilePicture","avatar","src","alt","toUpperCase","type","ref","onChange","accept","onClick","click","style","fontSize","padding","marginTop","color","role","email","studentInfo","studentNumber","departmentName","border","borderTop","margin","onSubmit","placeholder","disabled","textAlign","marginBottom","backgroundColor","_c","$RefreshReg$"],"sources":["C:/Users/zekierdem/Desktop/web_final/frontend/src/pages/Profile.jsx"],"sourcesContent":["// frontend/src/pages/Profile.jsx\r\nimport { useContext, useEffect, useState, useRef } from \"react\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport api from \"../api/axios\";\r\nimport \"../App.css\";\r\n\r\nexport default function Profile() {\r\n  const { user, updateUser } = useContext(AuthContext);\r\n  const fileInputRef = useRef(null);\r\n\r\n  const [form, setForm] = useState({\r\n    firstName: \"\",\r\n    lastName: \"\",\r\n    phone: \"\",\r\n  });\r\n\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [photoFile, setPhotoFile] = useState(null);\r\n  const [photoMessage, setPhotoMessage] = useState(\"\");\r\n  const [previewUrl, setPreviewUrl] = useState(null);\r\n\r\n  // Şifre state'leri\r\n  const [passForm, setPassForm] = useState({ current: \"\", new: \"\", newAgain: \"\" });\r\n  const [passMessage, setPassMessage] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      setForm({\r\n        firstName: user.firstName || \"\",\r\n        lastName: user.lastName || \"\",\r\n        phone: user.phone || \"\",\r\n      });\r\n    }\r\n  }, [user]);\r\n\r\n  // Clean up object URL when component unmounts or previewUrl changes\r\n  useEffect(() => {\r\n    return () => {\r\n      if (previewUrl && previewUrl.startsWith(\"blob:\")) {\r\n        URL.revokeObjectURL(previewUrl);\r\n      }\r\n    };\r\n  }, [previewUrl]);\r\n\r\n  if (!user) return <div className=\"profile-page\">Yükleniyor...</div>;\r\n\r\n  const handleChange = (e) => {\r\n    setForm({ ...form, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handlePassChange = (e) => {\r\n    setPassForm({ ...passForm, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  // --- KAYDET ---\r\n  const handleSaveProfile = async (e) => {\r\n    e.preventDefault();\r\n    setIsSaving(true);\r\n    try {\r\n      const res = await api.put(\"/users/me\", form);\r\n      updateUser(res.data?.user || { ...user, ...form });\r\n      alert(\"Profil başarıyla güncellendi!\");\r\n    } catch (err) {\r\n      alert(\"Hata oluştu: \" + (err.response?.data?.message || err.message));\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  // --- FOTOĞRAF SEÇME ---\r\n  const handleFileSelect = (e) => {\r\n    if (e.target.files && e.target.files[0]) {\r\n      const file = e.target.files[0];\r\n      setPhotoFile(file);\r\n\r\n      // Create preview\r\n      const objectUrl = URL.createObjectURL(file);\r\n      setPreviewUrl(objectUrl);\r\n\r\n      setPhotoMessage(\"Fotoğraf seçildi. Yüklemek için butona basınız.\");\r\n    }\r\n  };\r\n\r\n  // --- FOTOĞRAF YÜKLEME ---\r\n  const handleUploadPhoto = async () => {\r\n    if (!photoFile) {\r\n      setPhotoMessage(\"Lütfen önce bir fotoğraf seçin.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append(\"profilePicture\", photoFile);\r\n      formData.append(\"file\", photoFile);\r\n\r\n      // 1) Upload photo\r\n      await api.post(\"/users/me/profile-picture\", formData);\r\n\r\n      // 2) Fetch user again\r\n      const meRes = await api.get(\"/users/me\");\r\n\r\n      // Check for .data.data per strict DTO\r\n      if (meRes.data?.data) {\r\n        // Cache busting logic\r\n        const updatedUser = { ...meRes.data.data };\r\n        if (updatedUser.profilePictureUrl) {\r\n          updatedUser.profilePictureUrl = `${updatedUser.profilePictureUrl}?t=${new Date().getTime()}`;\r\n        }\r\n\r\n        updateUser(updatedUser);\r\n        setPhotoMessage(\"Profil fotoğrafı güncellendi!\");\r\n        setPreviewUrl(null); // Reset preview after successful upload\r\n        setPhotoFile(null);\r\n      } else {\r\n        setPhotoMessage(\r\n          \"Yükleme başarılı ama kullanıcı bilgisi alınamadı. Lütfen sayfayı yenileyin.\"\r\n        );\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Upload error:\", err.response || err);\r\n      setPhotoMessage(\r\n        \"Yükleme başarısız: \" +\r\n        (err.response?.data?.message ||\r\n          err.response?.data ||\r\n          err.message ||\r\n          \"Bilinmeyen hata\")\r\n      );\r\n    }\r\n  };\r\n\r\n  // --- ŞİFRE DEĞİŞTİRME ---\r\n  const handlePasswordSubmit = async () => {\r\n    setPassMessage(\"\");\r\n    if (!passForm.current || !passForm.new || !passForm.newAgain) {\r\n      setPassMessage(\"Lütfen tüm alanları doldurunuz.\");\r\n      return;\r\n    }\r\n    if (passForm.new !== passForm.newAgain) {\r\n      setPassMessage(\"Yeni şifreler eşleşmiyor.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await api.post(\"/users/me/change-password\", {\r\n        currentPassword: passForm.current,\r\n        newPassword: passForm.new,\r\n        confirmPassword: passForm.newAgain,\r\n      });\r\n      alert(\"Şifreniz başarıyla güncellendi!\");\r\n      setPassForm({ current: \"\", new: \"\", newAgain: \"\" });\r\n    } catch (err) {\r\n      console.error(err);\r\n      setPassMessage(err.response?.data?.message || \"Şifre değiştirilirken hata oluştu.\");\r\n    }\r\n  };\r\n\r\n  const fullName = `${user.firstName || \"\"} ${user.lastName || \"\"}`.trim();\r\n\r\n  // Determine Avatar URL\r\n  // Priority: Preview -> User's Profile Picture -> Fallback to null\r\n  let avatarUrl = previewUrl ||\r\n    user.profilePictureUrl ||\r\n    user.profilePictureURL ||\r\n    user.profilePicture ||\r\n    user.avatarUrl ||\r\n    user.avatar ||\r\n    null;\r\n\r\n  // Fix URL if it's from backend and relative\r\n  if (avatarUrl && !avatarUrl.startsWith(\"http\") && !avatarUrl.startsWith(\"blob:\")) {\r\n    avatarUrl = `http://localhost:5000${avatarUrl.startsWith(\"/\") ? \"\" : \"/\"}${avatarUrl}`;\r\n  }\r\n\r\n  return (\r\n    <div className=\"profile-page\">\r\n      <div className=\"profile-card\">\r\n        <h2 className=\"profile-title\">Profil Ayarları</h2>\r\n\r\n        {/* --- ÜST BÖLÜM --- */}\r\n        <div className=\"profile-header\">\r\n          <div className=\"avatar-section\">\r\n            <div className=\"avatar-circle\">\r\n              {avatarUrl ? (\r\n                <img src={avatarUrl} alt=\"Avatar\" className=\"avatar-img\" />\r\n              ) : (\r\n                <span>{user.firstName?.[0]?.toUpperCase()}</span>\r\n              )}\r\n            </div>\r\n\r\n            {/* GİZLİ INPUT VE ÖZEL BUTON */}\r\n            <input\r\n              type=\"file\"\r\n              ref={fileInputRef}\r\n              onChange={handleFileSelect}\r\n              className=\"hidden-input\"\r\n              accept=\"image/*\"\r\n            />\r\n\r\n            {!photoFile ? (\r\n              <button\r\n                type=\"button\"\r\n                className=\"custom-file-upload\"\r\n                onClick={() => fileInputRef.current.click()}\r\n              >\r\n                Fotoğraf Değiştir\r\n              </button>\r\n            ) : (\r\n              <button\r\n                type=\"button\"\r\n                className=\"btn-save\"\r\n                style={{ fontSize: '12px', padding: '8px 16px', marginTop: '5px' }}\r\n                onClick={handleUploadPhoto}\r\n              >\r\n                Onayla ve Yükle\r\n              </button>\r\n            )}\r\n\r\n            {photoMessage && <p style={{ fontSize: '12px', marginTop: 5, color: '#e67e22' }}>{photoMessage}</p>}\r\n          </div>\r\n\r\n          <div className=\"info-section\">\r\n            <h3>{fullName || \"Kullanıcı\"}</h3>\r\n            <span className=\"role-badge\">\r\n              {user.role === \"admin\" ? \"Yönetici\" : user.role === \"faculty\" ? \"Öğretim Üyesi\" : \"Öğrenci\"}\r\n            </span>\r\n            <p className=\"info-text\"><strong>E-posta:</strong> {user.email}</p>\r\n            {user.studentInfo && (\r\n              <p className=\"info-text\">\r\n                <strong>No:</strong> {user.studentInfo.studentNumber} | <strong>Bölüm:</strong> {user.studentInfo.departmentName}\r\n              </p>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <hr style={{ border: '0', borderTop: '1px solid #eee', margin: '0 0 30px 0' }} />\r\n\r\n        {/* --- FORM BÖLÜMÜ --- */}\r\n        <form onSubmit={handleSaveProfile}>\r\n          <h4 className=\"section-header\">Kişisel Bilgiler</h4>\r\n\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group\">\r\n              <label>Ad</label>\r\n              <input className=\"form-input\" name=\"firstName\" value={form.firstName} onChange={handleChange} />\r\n            </div>\r\n            <div className=\"form-group\">\r\n              <label>Soyad</label>\r\n              <input className=\"form-input\" name=\"lastName\" value={form.lastName} onChange={handleChange} />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group\">\r\n              <label>Telefon</label>\r\n              <input className=\"form-input\" name=\"phone\" value={form.phone} onChange={handleChange} placeholder=\"0555...\" />\r\n            </div>\r\n            <div className=\"form-group\">\r\n              <label>E-posta (Değiştirilemez)</label>\r\n              <input className=\"form-input\" value={user.email} disabled />\r\n            </div>\r\n          </div>\r\n\r\n          <div style={{ textAlign: 'right', marginBottom: '30px' }}>\r\n            <button type=\"submit\" className=\"btn-save\" disabled={isSaving}>\r\n              {isSaving ? \"Kaydediliyor...\" : \"Bilgileri Güncelle\"}\r\n            </button>\r\n          </div>\r\n        </form>\r\n\r\n        <hr style={{ border: '0', borderTop: '1px solid #eee', margin: '0 0 30px 0' }} />\r\n\r\n        {/* --- ŞİFRE BÖLÜMÜ --- */}\r\n        <h4 className=\"section-header\">Güvenlik</h4>\r\n        <div className=\"form-row\">\r\n          <div className=\"form-group\">\r\n            <label>Mevcut Şifre</label>\r\n            <input className=\"form-input\" type=\"password\" name=\"current\" value={passForm.current} onChange={handlePassChange} />\r\n          </div>\r\n        </div>\r\n        <div className=\"form-row\">\r\n          <div className=\"form-group\">\r\n            <label>Yeni Şifre</label>\r\n            <input className=\"form-input\" type=\"password\" name=\"new\" value={passForm.new} onChange={handlePassChange} />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label>Yeni Şifre (Tekrar)</label>\r\n            <input className=\"form-input\" type=\"password\" name=\"newAgain\" value={passForm.newAgain} onChange={handlePassChange} />\r\n          </div>\r\n        </div>\r\n        <button\r\n          type=\"button\"\r\n          className=\"btn-save\"\r\n          style={{ backgroundColor: '#607d8b' }}\r\n          onClick={handlePasswordSubmit}\r\n        >\r\n          Şifreyi Güncelle\r\n        </button>\r\n        {passMessage && <p style={{ marginTop: 10, color: '#e74c3c' }}>{passMessage}</p>}\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}